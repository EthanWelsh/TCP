<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Minet: minet_socket.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>minet_socket.cc File Reference</h1><code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_minet_8h_source.html">Minet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="minet__socket_8cc_source.html">minet_socket.h</a>&quot;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;sys/un.h&gt;</code><br/>
<code>#include &lt;netinet/in.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;netinet/tcp.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;sys/ioctl.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;sys/poll.h&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>

<p><a href="minet__socket_8cc_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a3a69c679f1dfbfcda4060df7dbe61b8b">UNINIT_SOCKS</a>&nbsp;&nbsp;&nbsp;-1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a52e0de67d4d0e9a0c74a8181c62d4189">KERNEL_SOCKS</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#ab21d08e13584858047debeaeabc31842">MINET_SOCKS</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a95e1d92b2619a326b2e86600f3d23100">EXTERNC</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#ad02c239fc0777062a46e259c3224ce08">SELECTPOLL_BROKEN</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740">minet_init</a> (<a class="el" href="minet__socket_8h.html#a19548e4c67534d1a8f42f3e770dc63d1">minet_socket_types</a> type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the Minet socket library.  <a href="#a1c3071d2961d94f18e08a4546a23f740"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#ab73e6d89f27f52ec6dcf8b2e1d6df021">minet_deinit</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function should be called by the application before it exits.  <a href="#ab73e6d89f27f52ec6dcf8b2e1d6df021"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a">minet_error</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the most recent error that occurred in a Minet function call.  <a href="#a13b935bebdc61d33fbca3101275bb28a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34">minet_perror</a> (const char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prints a description for the most recent error that occurred in a Minet function call.  <a href="#aa1c67d5c3fa57e48c57bec5eaec69f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#af917cb5064ee373a8fabf25dba4c6a4b">minet_socket</a> (int type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize an unbound socket and return its file descriptor.  <a href="#af917cb5064ee373a8fabf25dba4c6a4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a">minet_bind</a> (int sockfd, struct sockaddr_in *myaddr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assigns a socket a local address.  <a href="#a7c6dde5cb0d3802407c19d9e05e9d24a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a1b92471b80492ca3d6a4fb3f1031a69f">minet_listen</a> (int sockfd, int backlog)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepares a socket for receiving incoming connections.  <a href="#a1b92471b80492ca3d6a4fb3f1031a69f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#ae4194cef86abd3f1b660d0041fe27c0a">minet_accept</a> (int sockfd, struct sockaddr_in *addr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allows an incoming connection to connect to the socket.  <a href="#ae4194cef86abd3f1b660d0041fe27c0a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#abafc7fd037e7397b15542c1e82eb9547">minet_connect</a> (int sockfd, struct sockaddr_in *addr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Establishes a connection to a specified address.  <a href="#abafc7fd037e7397b15542c1e82eb9547"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4">minet_read</a> (int fd, char *buf, int len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempt to read data from a socket.  <a href="#a7d744783b5aca147a023cd2bfad644d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a4311ad22aab814e59a6140a40c09e48d">minet_write</a> (int fd, char *buf, int len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempt to write data to a socket.  <a href="#a4311ad22aab814e59a6140a40c09e48d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#ae99f5ee0f3d38cce764ccfa17c5ae472">minet_recvfrom</a> (int fd, char *buf, int len, struct sockaddr_in *from)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive data from a socket and store the source address.  <a href="#ae99f5ee0f3d38cce764ccfa17c5ae472"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#afdaede2bff8f4e63389604f4041f2dd0">minet_sendto</a> (int fd, char *buf, int len, struct sockaddr_in *to)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send data to a specific destination.  <a href="#afdaede2bff8f4e63389604f4041f2dd0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a1218302f3d2da8abf3a7d019c635c72a">minet_close</a> (int sockfd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#aef2ed4c3cc250ea842988a457a638f14">minet_select</a> (int minet_maxfd, fd_set *minet_read_fds, fd_set *minet_write_fds, fd_set *minet_except_fds, struct timeval *timeout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#abe3e1aa022930c8623c175e8a9e4abfc">minet_select_ex</a> (int minet_maxfd, fd_set *minet_read_fds, fd_set *minet_write_fds, fd_set *minet_except_fds, int unix_maxfd, fd_set *unix_read_fds, fd_set *unix_write_fds, fd_set *unix_except_fds, struct timeval *timeout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a34b2c4bbe8e9fe0cc80a31e42113a75a">minet_poll</a> (struct pollfd *minet_fds, int num_minet_fds, int timeout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a6c5cc96bd10378730b7c6a5c74d42a15">minet_poll_ex</a> (struct pollfd *minet_fds, int num_minet_fds, struct pollfd *unix_fds, int num_unix_fds, int timeout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking</a> (int sockfd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking</a> (int sockfd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a249b7ece83705c1f1955b3c7600bb2c5">minet_can_write_now</a> (int sockfd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXTERNC int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#aa54c507f22f2be74c7d5705e1c8b7a9a">minet_can_read_now</a> (int sockfd)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a702607628089b0e9b1baa39615f088b2">socket_type</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_minet_8h.html#aa92e423eb4aac3116a67315a4dd8a60e">MinetHandle</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#a122cc6e4fc3e6c05d53bccef3432c668">sock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977">minet_errno</a> = EOK</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains the error code of the most recent error to occur * inside a Minet socket library function call.  <a href="#aa623588010a1db5fee3d632b10687977"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a95e1d92b2619a326b2e86600f3d23100"></a><!-- doxytag: member="minet_socket.cc::EXTERNC" ref="a95e1d92b2619a326b2e86600f3d23100" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXTERNC</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00016">16</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a52e0de67d4d0e9a0c74a8181c62d4189"></a><!-- doxytag: member="minet_socket.cc::KERNEL_SOCKS" ref="a52e0de67d4d0e9a0c74a8181c62d4189" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_SOCKS&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00009">9</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ab21d08e13584858047debeaeabc31842"></a><!-- doxytag: member="minet_socket.cc::MINET_SOCKS" ref="ab21d08e13584858047debeaeabc31842" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MINET_SOCKS&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00010">10</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad02c239fc0777062a46e259c3224ce08"></a><!-- doxytag: member="minet_socket.cc::SELECTPOLL_BROKEN" ref="ad02c239fc0777062a46e259c3224ce08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SELECTPOLL_BROKEN&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01439">1439</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3a69c679f1dfbfcda4060df7dbe61b8b"></a><!-- doxytag: member="minet_socket.cc::UNINIT_SOCKS" ref="a3a69c679f1dfbfcda4060df7dbe61b8b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNINIT_SOCKS&nbsp;&nbsp;&nbsp;-1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00008">8</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae4194cef86abd3f1b660d0041fe27c0a"></a><!-- doxytag: member="minet_socket.cc::minet_accept" ref="ae4194cef86abd3f1b660d0041fe27c0a" args="(int sockfd, struct sockaddr_in *addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_accept </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>addr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allows an incoming connection to connect to the socket. </p>
<p>This function behaves similarly to the accept() function from Berkeley Sockets API. See the Linux manual page for <code>accept(2)</code> for additional help (<code>man 2 accept</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#ae4194cef86abd3f1b660d0041fe27c0a" title="Allows an incoming connection to connect to the socket.">minet_accept()</a> allows you to switch easily between using the Minet user stack and the kernel network stack. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the accept() function in the Berkeley Sockets API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sockfd</em>&nbsp;</td><td>Handle to a socket that is currently in the <a class="el" href="minet__socket_8cc.html#a1b92471b80492ca3d6a4fb3f1031a69f">listening</a> state. Note that upon return, this socket * goes back to the listening state and will be available to receive additional connection requests. The actual connection with the * client is made using the socket handle that is returned by this function. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>addr</em>&nbsp;</td><td>Pointer to a sockaddr structure to receive the client's address information, or <code>NULL</code> if this information is not required. See the remarks section for more information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns a new socket descriptor on which the actual connection to the client is made. (The parameter * sockfd is returned to the listening state and is not associated with the connection.) </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>accept(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</dd></dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>Yes, unless the socket is in non-blocking mode. See <a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking()</a> and <a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking()</a>.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For servers with connection-based socket types (e.g., TCP), the accept() function is used to accept incoming connection requests before the server can * exchange data with the client. In Minet, data can be exchanged using <a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> and <a class="el" href="minet__socket_8cc.html#a4311ad22aab814e59a6140a40c09e48d" title="Attempt to write data to a socket.">minet_write()</a>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Connectionless socket types (e.g., UDP) do not need to call accept(). They can begin exchanging data </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that this function is blocking - if there is no connection request present when accept() is called, this function will block until one arrives. You can use <a class="el" href="minet__socket_8cc.html#aef2ed4c3cc250ea842988a457a638f14">minet_select()</a> and <a class="el" href="minet__socket_8cc.html#a34b2c4bbe8e9fe0cc80a31e42113a75a">minet_poll()</a> to avoid unnecessary blocking behavior. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>In Linux, the <code>sockaddr_in</code> structure is defined in the &lt;netinet/in.h&gt; header. It typically looks like this: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>sockaddr_in {
        <span class="keywordtype">short</span>            sin_family;   <span class="comment">// Address family (AF_INET, AF_INET6, etc.)</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>   sin_port;     <span class="comment">// Port number. For example: htons(3490)</span>
        <span class="keyword">struct </span>in_addr   sin_addr;     <span class="comment">// See below.</span>
};
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>And the <code>in_addr</code> structure typically looks like this: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>in_addr {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> s_addr;          <span class="comment">// Write using inet_pton(), or use a special IP address such as INADDR_ANY.</span>
};
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that byte ordering is a concern in networking code, so you should use the ntohs() function if you intend on reading and storing the port number in <code>sockaddr_in.sin_port</code> locally. See <a href="http://beej.us/guide/bgnet/output/html/multipage/htonsman.html">Section 9.12</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>To convert the IP address to a string (e.g., for display), you can use the inet_ntop() function from &lt;arpa/inet.h&gt;. See <a href="http://beej.us/guide/bgnet/output/html/multipage/inet_ntopman.html">Section 9.14</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Does Minet *actually* support non-blocking sockets for MINET_USER at the moment? After searching around in the code, it seems that mSET_NONBLOCKING * currently doesn't actually do anything. Maybe it doesn't need to? (Test it!)</dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00789">789</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a7c6dde5cb0d3802407c19d9e05e9d24a"></a><!-- doxytag: member="minet_socket.cc::minet_bind" ref="a7c6dde5cb0d3802407c19d9e05e9d24a" args="(int sockfd, struct sockaddr_in *myaddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_bind </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>myaddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assigns a socket a local address. </p>
<p>This function behaves similarly to the bind() function from Berkeley Sockets API (substituting <code>sizeof(*myaddr)</code> for the <code>len</code> argument). See the Linux manual page for <code>bind(2)</code> for additional help (<code>man 2 bind</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a" title="Assigns a socket a local address.">minet_bind()</a> allows you to switch easily between using the Minet user stack and the kernel network stack. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the bind() function in the Berkeley Sockets API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sockfd</em>&nbsp;</td><td>Handle to an unbound socket that was created using <a class="el" href="minet__socket_8cc.html#af917cb5064ee373a8fabf25dba4c6a4b" title="Initialize an unbound socket and return its file descriptor.">minet_socket()</a>.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>myaddr</em>&nbsp;</td><td>Pointer to a sockaddr_in structure which may contain (depending on the address family) the desired local IP address, a port * number for the socket, among other possible fields that will be assigned to the socket. See the remarks section for more information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns 0. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>bind(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating. </p>
<dl class="user"><dt><b></b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet * did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</dd></dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>No</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For servers, the bind() function is typically used to assign the port number on which the server process will be listening. Clients generally do not need to call bind().</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>In Linux, the <code>sockaddr_in</code> structure is defined in the &lt;netinet/in.h&gt; header. It typically looks like this: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">struct </span>sockaddr_in {
        <span class="keywordtype">short</span>            sin_family;   <span class="comment">// Address family (AF_INET, AF_INET6, etc.)</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>   sin_port;     <span class="comment">// Port number. For example: htons(3490)</span>
        <span class="keyword">struct </span>in_addr   sin_addr;     <span class="comment">// See below.</span>
};
</pre></div> <dl class="user"><dt><b></b></dt><dd>And the <code>in_addr</code> structure typically looks like this: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>in_addr {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> s_addr;          <span class="comment">// Write using inet_pton(), or use a special IP address such as INADDR_ANY.</span>
};
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Servers generally use <code>INADDR_ANY</code> for the <code>sockaddr_in.sin_addr</code> field. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that Minet currently supports only the IPv4 address family. Therefore, you should use <code>AF_INET</code> for <code>sockaddr_in.sin_family</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that byte ordering is a concern in networking code, so you should use the htons() function for storing the port number in Network Byte Order for the <code>sockaddr_in.sin_port</code> field. See <a href="http://beej.us/guide/bgnet/output/html/multipage/htonsman.html">Section 9.12</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>How much additional work would it take to make Minet support IPv6 addresses? </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00582">582</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa54c507f22f2be74c7d5705e1c8b7a9a"></a><!-- doxytag: member="minet_socket.cc::minet_can_read_now" ref="aa54c507f22f2be74c7d5705e1c8b7a9a" args="(int sockfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_can_read_now </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01904">1904</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a249b7ece83705c1f1955b3c7600bb2c5"></a><!-- doxytag: member="minet_socket.cc::minet_can_write_now" ref="a249b7ece83705c1f1955b3c7600bb2c5" args="(int sockfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_can_write_now </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01866">1866</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1218302f3d2da8abf3a7d019c635c72a"></a><!-- doxytag: member="minet_socket.cc::minet_close" ref="a1218302f3d2da8abf3a7d019c635c72a" args="(int sockfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_close </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01408">1408</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abafc7fd037e7397b15542c1e82eb9547"></a><!-- doxytag: member="minet_socket.cc::minet_connect" ref="abafc7fd037e7397b15542c1e82eb9547" args="(int sockfd, struct sockaddr_in *addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_connect </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>addr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Establishes a connection to a specified address. </p>
<p>This function behaves similarly to the connect() function from Berkeley Sockets API (substituting <code>sizeof(*myaddr)</code> for the <code>len</code> argument). See the Linux manual page for <code>connect(2)</code> for additional help (<code>man 2 connect</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#abafc7fd037e7397b15542c1e82eb9547" title="Establishes a connection to a specified address.">minet_connect()</a> allows you to switch easily between using the Minet user stack and the kernel network stack. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the connect() function in the Berkeley Sockets API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sockfd</em>&nbsp;</td><td>Handle to an unbound socket created using <a class="el" href="minet__socket_8cc.html#af917cb5064ee373a8fabf25dba4c6a4b" title="Initialize an unbound socket and return its file descriptor.">minet_socket()</a>. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>addr</em>&nbsp;</td><td>Pointer to a sockaddr_in structure containing the destination address. See the remarks section for more information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns 0. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>connect(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</dd></dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>Yes, unless the socket is in non-blocking mode. See <a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking()</a> and <a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking()</a>.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>connect() is typically used by connection-oriented clients (e.g., TCP) to establish a connection with a server before they can exchange data. In the case of Minet, data exchange is done using <a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> and <a class="el" href="minet__socket_8cc.html#a4311ad22aab814e59a6140a40c09e48d" title="Attempt to write data to a socket.">minet_write()</a> for connection-oriented sockets, and <a class="el" href="minet__socket_8cc.html#afdaede2bff8f4e63389604f4041f2dd0" title="Send data to a specific destination.">minet_sendto()</a> and <a class="el" href="minet__socket_8cc.html#ae99f5ee0f3d38cce764ccfa17c5ae472" title="Receive data from a socket and store the source address.">minet_recvfrom()</a> for connectionless sockets. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>You can use <code>getaddrinfo()</code> to convert a human-readable hostname or IP address into its binary representation for use with this function. See the Linux manual page for <code>getaddrinfo(3)</code> (<code>man 3 getaddrinfo</code>), or <a href="http://beej.us/guide/bgnet/output/html/multipage/getaddrinfoman.html">Section 9.5</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>In Linux, the <code>sockaddr_in</code> structure is defined in the &lt;netinet/in.h&gt; header. It typically looks like this: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>sockaddr_in {
        <span class="keywordtype">short</span>            sin_family;   <span class="comment">// Address family (AF_INET, AF_INET6, etc.)</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>   sin_port;     <span class="comment">// Port number. For example: htons(3490)</span>
        <span class="keyword">struct </span>in_addr   sin_addr;     <span class="comment">// See below.</span>
};
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>And the <code>in_addr</code> structure typically looks like this: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>in_addr {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> s_addr;          <span class="comment">// Write using inet_pton(), or use a special IP address such as INADDR_ANY.</span>
};
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that Minet currently supports only the IPv4 address family. Therefore, you should use <code>AF_INET</code> for <code>sockaddr_in.sin_family</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that byte ordering is a concern in networking code, so you should use the htons() function for storing the port number in Network Byte Order for the <code>sockaddr_in.sin_port</code> field. See <a href="http://beej.us/guide/bgnet/output/html/multipage/htonsman.html">Section 9.12</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Should I be mentioning that in here (as well as the docs for some other functions in this file) that, for MINET_USER, * this will actually construct a <a class="el" href="struct_sock_lib_request_response.html">SockLibRequestResponse</a> message (of type mCONNECT) and send it to the specified destination? * And that the remote peer will then respond with another (STATUS?) message? Certainly, when students are working on the http client/server project, they wouldn't care, but * if someone is working on a lower level module (or if you're a Minet developer), this might suddenly be a concern and should * probably be mentioned.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Some additional documentation is needed here and elsewhere (e.g., <a class="el" href="minet__socket_8cc.html#ae4194cef86abd3f1b660d0041fe27c0a" title="Allows an incoming connection to connect to the socket.">minet_accept()</a>) for non-blocking sockets. Also, the "Blocking?" sections in other places may need * to be adjusted in a similar manner as in here ("unless the socket is in non-blocking
 mode...").</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>Connectionless sockets sometimes use connect() to set the default destination address for subsequent send() and recv() calls. It doesn't look like Minet has corresponding * minet_send() or minet_recv() functions, although it has <a class="el" href="minet__socket_8cc.html#a4311ad22aab814e59a6140a40c09e48d" title="Attempt to write data to a socket.">minet_write()</a> and <a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> - will this functionality (default destination address) be accomplished using these? * From looking at <a class="el" href="udp__client_8cc.html">udp_client.cc</a> and <a class="el" href="udp__server_8cc.html">udp_server.cc</a>, it looks like yes, but test it anyway (using sendto() vs write(), and recvfrom() vs read()). * We might want to write a minet_send() and minet_recv() anyways. Why? 1.) If we're going to port this to Windows at any time, we would prefer to use send() and * recv() instead of write() and read() since sockets aren't treated like files on Windows. 2.) just to achieve maximum parallelism with Berkeley sockets, we should probably implement * these minet_send() and minet_recv() functions. (Although note that there may be some confusion with the similarly-named MinetSend() and MinetReceive(), which can be clarified if necessary.) </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00943">943</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ab73e6d89f27f52ec6dcf8b2e1d6df021"></a><!-- doxytag: member="minet_socket.cc::minet_deinit" ref="ab73e6d89f27f52ec6dcf8b2e1d6df021" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_deinit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function should be called by the application before it exits. </p>
<p>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, this will shut down the Minet stack and perform cleanup.</p>
<p>This function currently does nothing if <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Return value is currently -1 (because that's what UNINIT_SOCKS is defined to be), which signifies error. Perhaps it should return 0 or EOK. Then we can document the return value.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Perhaps this function should call shutdown() on the socket in the case of MINET_KERNEL. Doesn't look like we ever do this (although it's not a big deal, I suppose).</dd></dl>
<p>(We would need the sockfd param as well, if we do this).</p>
<p>(For maximum parallelism with Berkeley sockets, we might want to name this function minet_shutdown(), but on the other hand, that would be rather confusing as one would * think that this would shut down all of Minet, but it just closes the socket!). </p>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00175">175</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a13b935bebdc61d33fbca3101275bb28a"></a><!-- doxytag: member="minet_socket.cc::minet_error" ref="a13b935bebdc61d33fbca3101275bb28a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_error </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the most recent error that occurred in a Minet function call. </p>
<p>This function will correctly obtain the error code of the most recent error based on whether Minet was initialized using the kernel stack or the Minet user stack (see <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a>).</p>
<p>You may find that it is more useful to call <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> instead which will print a description of the error based on the error code.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, this function * returns the error code of the most recent error that occurred in * the system. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, this function returns the error code of the most recent error that occurred in Minet.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Many system-level calls as well as functions inside Minet notify the caller of an error condition * by storing an error code inside a global variable. In Minet, this variable is called <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a>. In many operating * systems, this variable is called <code>errno</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If Minet was initialized using the kernel stack, the Minet socket library will use system calls for socket programming; as such, if any errors occur, <code>errno</code> would be the correct variable to use for error reporting. If, on the other hand, Minet was initialized using the Minet user stack, <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a> should be used. This function will return the correct error code depending on how Minet was initialized when <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>This function will only return a meaningful result if the return value of the most recent Minet function call indicated that an error occurred, <b>and</b> the documentation for that Minet function stated that you could call <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> to get more information about the error. Not all Minet functions use <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a> for reporting error codes, so <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> will not always give you meaningful information; furthermore, calling additional Minet functions may change the value of <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a>, so you should always call <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> immediately after the function that failed. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Within Minet, an error code of <code>ENODEV</code> ("no device error") is often used to signify that Minet was not initialized properly. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> succeeded. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>You can set <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>For more information about <code>errno</code> in Linux, see the manual page entry for <code>errno(3)</code> (<code>man 3 errno</code>).</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a>, <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a></dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>The value of minet_errno is useless to the user unless we provide him/her with the corresponding values (or at least define all the error codes in one easy-to-find place (such as "error.h", perhaps?)). Otherwise, the user just might as well call <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> instead.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>This function does some strange things in the case of UNINIT_SOCKS... it sets errno instead of minet_errno, and returns -1. Maybe we should make that case equivalent to the default: case. UNINIT_SOCKS will only happen if <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with an invalid argument, which would mean that Minet was not initialized correctly, which is (in my understanding) what minet_errno=ENODEV is supposed to represent (at least that's how I've been documenting it all along...). It would make more sense to set minet_errno to some representation of "invalid argument" if <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> is called with something other than MINET_USER or MINET_KERNEL. But then the UNINIT_SOCKS case ought to be equivalent to MINET_USER case... otherwise, this function would wipe out the "invalid
 argument" error code with the ENODEV error code. I'm tempted to make a third "errno"-type global var just for UNINIT_SOCKS, but that would uglify things even further. BLARGH! </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00267">267</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1c3071d2961d94f18e08a4546a23f740"></a><!-- doxytag: member="minet_socket.cc::minet_init" ref="a1c3071d2961d94f18e08a4546a23f740" args="(minet_socket_types type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="minet__socket_8h.html#a19548e4c67534d1a8f42f3e770dc63d1">minet_socket_types</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the Minet socket library. </p>
<p>This function must be called before any of the Minet socket library functions in <a class="el" href="minet__socket_8h.html">minet_socket.h</a> could be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Specifies whether to use the kernel networking stack or the Minet user stack.</p>
<ul>
<li>MINET_KERNEL: Use the kernel * networking stack. (This * will bypass all Minet modules lower than <code>*</code> * libminet_socket).</li>
<li>MINET_USER: Use the Minet user stack.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the Minet socket library initialized successfully, this * function returns the networking stack being used (either * MINET_KERNEL or MINET_USER). </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If the library did not initialize * successfully, a negative value * is returned. * To get more information about the error, you * can * use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> * functions, or set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> to * something greater than 0 in setup.sh to see * * debugging messages while Minet is running.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The Minet socket library requires that the sock_module * is loaded and operational. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The ability to easily switch between the kernel networking stack and the Minet user stack is useful when you are writing a module for Minet. If your module is not functioning correctly when initialized using the Minet user stack (MINET_USER), try switching to the kernel stack (MINET_KERNEL). This will bypass the Minet stack entirely and will allow you to discover whether the problem occurs inside your module (which will load as part of the Minet user stack if you called this function with MINET_USER), or elsewhere. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>You can set <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> to 1 in <code>setup.sh</code> or greater to see more information about errors that occur while Minet is operating.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>The meaning of the return value is a little confusing. Even describing it was a little awkward. How about returning EOK or 0? (There appears to be a sort of convention in Minet that a return value &gt;= 0 signifies success, while a negative return value signifies an error. Can we formalize this?)</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>It's a little confusing that there's a <a class="el" href="_minet_8cc.html#a1d2222bdbc1d4563d42022560464233f">MinetInit()</a> in <a class="el" href="_minet_8h.html">Minet.h</a> and a <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> here. Consider renaming this function to something a little more descriptive (init_minet_socket_lib() perhaps, or something along those lines?). </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00116">116</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a1b92471b80492ca3d6a4fb3f1031a69f"></a><!-- doxytag: member="minet_socket.cc::minet_listen" ref="a1b92471b80492ca3d6a4fb3f1031a69f" args="(int sockfd, int backlog)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_listen </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>backlog</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepares a socket for receiving incoming connections. </p>
<p>This function behaves similarly to the listen() function from Berkeley Sockets API. See the Linux manual page for <code>listen(2)</code> for additional help (<code>man 2 listen</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#a1b92471b80492ca3d6a4fb3f1031a69f" title="Prepares a socket for receiving incoming connections.">minet_listen()</a> allows you to switch easily between using the Minet user stack and the kernel network stack. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the listen() function in the Berkeley Sockets API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sockfd</em>&nbsp;</td><td>- Handle to a <a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a">bound</a> socket. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>backlog</em>&nbsp;</td><td>- An integer representing the number of pending connections that can be queued up at any one time. See the Linux manual page * for <code>listen(2)</code> for more information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>No</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns 0. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>listen(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful. </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00662">662</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa1c67d5c3fa57e48c57bec5eaec69f34"></a><!-- doxytag: member="minet_socket.cc::minet_perror" ref="aa1c67d5c3fa57e48c57bec5eaec69f34" args="(const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_perror </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prints a description for the most recent error that occurred in a Minet function call. </p>
<p>This function will translate the error code given by <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> into a meaningful message and print it out to the standard error stream.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td>If not NULL, this function will print <code>s</code>, followed by a colon and a space, * and then the error description to the standard error stream. </td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b></b></dt><dd>If NULL, this function will only print the error description to the standard error stream. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>You can optionally use this parameter to prepend the error description with a message of your own (it may be useful to print the name of the function where the error occurred, for example).</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>See the documentation for <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> for more information on error codes.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function behaves similarly to the <code>perror</code> routine in Linux. See the manual page entry for <code>perror(3)</code>.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a>, <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a></dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>This should call <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a>. Currently, it duplicates its logic. If you change <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a>, you might be confused (or at least * slightly disappointed) to find that <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> still behaves the same.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>The current remarks section is kind of a cop-out.</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>should only print ": " if s is not NULL. </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00324">324</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a34b2c4bbe8e9fe0cc80a31e42113a75a"></a><!-- doxytag: member="minet_socket.cc::minet_poll" ref="a34b2c4bbe8e9fe0cc80a31e42113a75a" args="(struct pollfd *minet_fds, int num_minet_fds, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_poll </td>
          <td>(</td>
          <td class="paramtype">struct pollfd *&nbsp;</td>
          <td class="paramname"> <em>minet_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_minet_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01664">1664</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a6c5cc96bd10378730b7c6a5c74d42a15"></a><!-- doxytag: member="minet_socket.cc::minet_poll_ex" ref="a6c5cc96bd10378730b7c6a5c74d42a15" args="(struct pollfd *minet_fds, int num_minet_fds, struct pollfd *unix_fds, int num_unix_fds, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_poll_ex </td>
          <td>(</td>
          <td class="paramtype">struct pollfd *&nbsp;</td>
          <td class="paramname"> <em>minet_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_minet_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pollfd *&nbsp;</td>
          <td class="paramname"> <em>unix_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_unix_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01719">1719</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a7d744783b5aca147a023cd2bfad644d4"></a><!-- doxytag: member="minet_socket.cc::minet_read" ref="a7d744783b5aca147a023cd2bfad644d4" args="(int fd, char *buf, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_read </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Attempt to read data from a socket. </p>
<p>This function behaves similarly to the read() function from the POSIX API. See the Linux manual page for <code>read(2)</code> for additional help (<code>man 2 read</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> allows you to switch easily between using the Minet user stack and the kernel network stack for reading from a socket. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the Unix read() function from the POSIX API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used, and the read operation will be performed by interacting with the Minet socket module.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fd</em>&nbsp;</td><td>Handle to a connected socket. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>Pointer to a buffer that will receive the incoming data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>Maximum number of bytes to read from the socket.</td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>Yes, unless the socket is in non-blocking mode. See <a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking()</a> and <a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking()</a>.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns the number of bytes read from the socket. Zero indicates that the sender has closed * the connection (this is the regular way to check for an orderly shutdown on a socket).</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>read(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For connection-oriented sockets (such as TCP), the socket must be connected before any data can be received. For clients, this typically means that <a class="el" href="minet__socket_8cc.html#abafc7fd037e7397b15542c1e82eb9547" title="Establishes a connection to a specified address.">minet_connect()</a> must have been called beforehand. For servers, this typically means that <a class="el" href="minet__socket_8cc.html#ae4194cef86abd3f1b660d0041fe27c0a" title="Allows an incoming connection to connect to the socket.">minet_accept()</a> must have been called.</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>For connectionless sockets (such as UDP), the socket must be <a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a">bound</a>.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that this function is blocking - if there is no data when <a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> is called, this function will block until data arrives. You can use <a class="el" href="minet__socket_8cc.html#aef2ed4c3cc250ea842988a457a638f14">minet_select()</a> and <a class="el" href="minet__socket_8cc.html#a34b2c4bbe8e9fe0cc80a31e42113a75a">minet_poll()</a> to avoid unnecessary blocking behavior.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that not all of the data will necessarily be read in a single call. It may be necessary to put the read function inside a loop. </p>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01061">1061</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae99f5ee0f3d38cce764ccfa17c5ae472"></a><!-- doxytag: member="minet_socket.cc::minet_recvfrom" ref="ae99f5ee0f3d38cce764ccfa17c5ae472" args="(int fd, char *buf, int len, struct sockaddr_in *from)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_recvfrom </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>from</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receive data from a socket and store the source address. </p>
<p>This function behaves similarly to the recvfrom() function from &lt;sys/socket.h&gt;. See the Linux manual page for <code>recvfrom(2)</code> for additional help (<code>man 2 recvfrom</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#ae99f5ee0f3d38cce764ccfa17c5ae472" title="Receive data from a socket and store the source address.">minet_recvfrom()</a> allows you to switch easily between using the Minet user stack and the kernel network stack for reading from a socket. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the recvfrom() function from &lt;sys/socket.h&gt;. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used, and the read operation will be performed by interacting with the Minet socket module.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fd</em>&nbsp;</td><td>Handle to a socket (which may or may not be connected). </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>Pointer to a buffer that will receive the incoming data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>Maximum number of bytes to read from the socket. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>from</em>&nbsp;</td><td>Pointer to a sockaddr structure to receive the source address information, or <code>NULL</code> if this information is not required. See the remarks section for more information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd>Yes, unless the socket is in non-blocking mode. See * <a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking()</a> and <a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking()</a>.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>
<p>If the call was successful, this function returns the number of * bytes read from the socket. Zero indicates that the sender has * closed * the connection (this is the regular way to check for * an orderly shutdown on a socket).</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>recvfrom(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd></dd></dl>
<p>recvfrom() is typically used by connectionless sockets (such as UDP).</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>The socket must be bound before <a class="el" href="minet__socket_8cc.html#ae99f5ee0f3d38cce764ccfa17c5ae472" title="Receive data from a socket and store the source address.">minet_recvfrom()</a> can be used. For servers, this is accomplished explicitly using <a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a" title="Assigns a socket a local address.">minet_bind()</a>. For clients, this is generally accomplished implicitly via a prior call to <a class="el" href="minet__socket_8cc.html#afdaede2bff8f4e63389604f4041f2dd0" title="Send data to a specific destination.">minet_sendto()</a>.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that this function is blocking - if there is no data when <a class="el" href="minet__socket_8cc.html#a7d744783b5aca147a023cd2bfad644d4" title="Attempt to read data from a socket.">minet_read()</a> is called, this function will block until data arrives. You can use <a class="el" href="minet__socket_8cc.html#aef2ed4c3cc250ea842988a457a638f14">minet_select()</a> and <a class="el" href="minet__socket_8cc.html#a34b2c4bbe8e9fe0cc80a31e42113a75a">minet_poll()</a> to avoid unnecessary blocking behavior.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that not all of the data will necessarily be read in a single call. It may be necessary to place the function call inside a loop.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>In Linux, the <code>sockaddr_in</code> structure is defined in the &lt;netinet/in.h&gt; header. It typically looks like this: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">struct </span>sockaddr_in {
        <span class="keywordtype">short</span>            sin_family;   <span class="comment">// Address family (AF_INET, AF_INET6, etc.)</span>
        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>   sin_port;     <span class="comment">// Port number. For example: htons(3490)</span>
        <span class="keyword">struct </span>in_addr   sin_addr;     <span class="comment">// See below.</span>
};
</pre></div><dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>And the <code>in_addr</code> structure typically looks like this: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">struct </span>in_addr {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> s_addr;          <span class="comment">// Write using inet_pton(), or use a special IP address such as INADDR_ANY.</span>
};
</pre></div><dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that byte ordering is a concern in networking code, so you should use the ntohs() function if you intend on reading and storing the port number in <code>sockaddr_in.sin_port</code> locally. See <a href="http://beej.us/guide/bgnet/output/html/multipage/htonsman.html">Section 9.12</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>To convert the IP address to a string (e.g., for display), you can use the inet_ntop() function from &lt;arpa/inet.h&gt;. See <a href="http://beej.us/guide/bgnet/output/html/multipage/inet_ntopman.html">Section 9.14</a> in <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej's Guide to Network Programming</a> for more information.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000002">Bug:</a></b></dt><dd>Will crash if you pass NULL for the "from" param.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>Technically, it is possible to use recvfrom() with TCP, but the code currently assumes it will only be used with UDP when the <a class="el" href="struct_sock_lib_request_response.html">SockLibRequestResponse</a> object is being constructed. </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01317">1317</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aef2ed4c3cc250ea842988a457a638f14"></a><!-- doxytag: member="minet_socket.cc::minet_select" ref="aef2ed4c3cc250ea842988a457a638f14" args="(int minet_maxfd, fd_set *minet_read_fds, fd_set *minet_write_fds, fd_set *minet_except_fds, struct timeval *timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_select </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>minet_maxfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_read_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_write_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_except_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01445">1445</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abe3e1aa022930c8623c175e8a9e4abfc"></a><!-- doxytag: member="minet_socket.cc::minet_select_ex" ref="abe3e1aa022930c8623c175e8a9e4abfc" args="(int minet_maxfd, fd_set *minet_read_fds, fd_set *minet_write_fds, fd_set *minet_except_fds, int unix_maxfd, fd_set *unix_read_fds, fd_set *unix_write_fds, fd_set *unix_except_fds, struct timeval *timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_select_ex </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>minet_maxfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_read_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_write_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>minet_except_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>unix_maxfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>unix_read_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>unix_write_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&nbsp;</td>
          <td class="paramname"> <em>unix_except_fds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01549">1549</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="afdaede2bff8f4e63389604f4041f2dd0"></a><!-- doxytag: member="minet_socket.cc::minet_sendto" ref="afdaede2bff8f4e63389604f4041f2dd0" args="(int fd, char *buf, int len, struct sockaddr_in *to)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_sendto </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>to</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send data to a specific destination. </p>
<p>====== YOU'RE HERE ====== </p>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01368">1368</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af86ea46b97900ebb143d8e2a75d67f83"></a><!-- doxytag: member="minet_socket.cc::minet_set_blocking" ref="af86ea46b97900ebb143d8e2a75d67f83" args="(int sockfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_set_blocking </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01825">1825</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a95f6dfb2e839a5ebb5d1dd1c99ae5c02"></a><!-- doxytag: member="minet_socket.cc::minet_set_nonblocking" ref="a95f6dfb2e839a5ebb5d1dd1c99ae5c02" args="(int sockfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_set_nonblocking </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sockfd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>Does Minet *actually* support non-blocking sockets for * MINET_USER at the moment? After searching around in the code, it * seems that mSET_NONBLOCKING * currently doesn't actually do * anything. Maybe it doesn't need to? (Test it!) </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01784">1784</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af917cb5064ee373a8fabf25dba4c6a4b"></a><!-- doxytag: member="minet_socket.cc::minet_socket" ref="af917cb5064ee373a8fabf25dba4c6a4b" args="(int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_socket </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize an unbound socket and return its file descriptor. </p>
<p>This function behaves similarly to the socket() function from Berkeley Sockets API (substituting <code>AF_INET</code> for the <code>domain</code> argument and <code>0</code> for protocol). See the Linux manual page for <code>socket(2)</code> for additional help (<code>man 2 socket</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#af917cb5064ee373a8fabf25dba4c6a4b" title="Initialize an unbound socket and return its file descriptor.">minet_socket()</a> allows you to switch easily between using the Minet user stack and the kernel network stack. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the socket() function in the Berkeley Sockets API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>The type of socket to create. The following values are supported:</p>
<ul>
<li>SOCK_STREAM for TCP sockets</li>
<li>SOCK_DGRAM for UDP sockets</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Handle to the socket if the call was successful. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>A negative return value signifies an error. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following table describes the meaning of the possible * error codes that <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> could return if this function failed:<ul>
<li>ENODEV (Minet user stack only) <br/>
 Minet was not initialized properly. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful, and that <a class="el" href="minet__socket_8cc.html#ab73e6d89f27f52ec6dcf8b2e1d6df021" title="This function should be called by the application before it exits.">minet_deinit()</a> was not called at any time afterward.</li>
<li>EAFNOSUPPORT <br/>
 The implementation does not support the specified address family.</li>
<li>EMFILE <br/>
 No more file descriptors are available for this process.</li>
<li>ENFILE <br/>
 No more file descriptors are available for the system.</li>
<li>EPROTONOSUPPORT <br/>
 The protocol is not supported by the address family, or the protocol is not supported by the implementation.</li>
<li>EPROTOTYPE <br/>
 The socket type is not supported by the protocol.</li>
<li>EACCES <br/>
 The process does not have appropriate privileges.</li>
<li>ENOBUFS <br/>
 Insufficient resources were available in the system to perform the operation.</li>
<li>ENOMEM <br/>
 Insufficient memory was available to fulfill the request. </li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd>Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or * greater to see more information about errors * that occur while Minet is operating.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>SOCK_ICMP for ICMP sockets is not yet supported for MINET_USER. </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>SOCK_STREAM and SOCK_DGRAM are defined inside the &lt;sys/socket.h&gt; header. </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00447">447</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a4311ad22aab814e59a6140a40c09e48d"></a><!-- doxytag: member="minet_socket.cc::minet_write" ref="a4311ad22aab814e59a6140a40c09e48d" args="(int fd, char *buf, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERNC int minet_write </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Attempt to write data to a socket. </p>
<p>This function behaves similarly to the write() function from the POSIX API. See the Linux manual page for <code>write(2)</code> for additional help (<code>man 2 write</code>).</p>
<p><a class="el" href="minet__socket_8cc.html#a4311ad22aab814e59a6140a40c09e48d" title="Attempt to write data to a socket.">minet_write()</a> allows you to switch easily between using the Minet user stack and the kernel network stack for writing to a socket. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_KERNEL, then the kernel networking stack will be used, and this function will behave identically to the Unix write() function from the POSIX API. If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, then the Minet user stack will be used, and the write operation will be performed by interacting with the Minet socket module.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fd</em>&nbsp;</td><td>Handle to a connected socket. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>Pointer to a buffer that containing the data to be transmitted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>Maximum number of bytes to be written to the socket.</td></tr>
  </table>
  </dd>
</dl>
<dl class="user"><dt><b>Blocking?</b></dt><dd></dd></dl>
<p>Yes, unless the socket is in non-blocking mode. See <a class="el" href="minet__socket_8cc.html#af86ea46b97900ebb143d8e2a75d67f83">minet_set_blocking()</a> and <a class="el" href="minet__socket_8cc.html#a95f6dfb2e839a5ebb5d1dd1c99ae5c02">minet_set_nonblocking()</a>.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the call was successful, this function returns the actual number of bytes sent. Note that this could be less than the number of bytes requested in the <code>len</code> parameter.</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If the call was not successful, this function returns -1. To get more information about the error, you can use the <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> * or <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a> functions. See the Linux manual page for <code>write(2)</code> for a list of possible error codes. Additionally, you can set * <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>If <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was called with MINET_USER, an error code of <code>ENODEV</code> is used to signify that Minet did not initialize successfully. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> was successful.</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For connection-oriented sockets (such as TCP), the socket must be connected before any data can be sent. For clients, this typically means that <a class="el" href="minet__socket_8cc.html#abafc7fd037e7397b15542c1e82eb9547" title="Establishes a connection to a specified address.">minet_connect()</a> must have been called beforehand. For servers, this typically means that <a class="el" href="minet__socket_8cc.html#ae4194cef86abd3f1b660d0041fe27c0a" title="Allows an incoming connection to connect to the socket.">minet_accept()</a> must have been called.</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>For connectionless sockets (such as UDP), the socket must be <a class="el" href="minet__socket_8cc.html#a7c6dde5cb0d3802407c19d9e05e9d24a">bound</a>.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that this function is blocking - if the write operation cannot be completed immediately, this function will block until the operation has completed. You can use <a class="el" href="minet__socket_8cc.html#aef2ed4c3cc250ea842988a457a638f14">minet_select()</a> to determine when a socket is ready for writing.</p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>Note that not all of the data will necessarily be written in a single call. It may be necessary to put the write function inside a loop. </p>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l01170">1170</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aa623588010a1db5fee3d632b10687977"></a><!-- doxytag: member="minet_socket.cc::minet_errno" ref="aa623588010a1db5fee3d632b10687977" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977">minet_errno</a> = EOK</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Contains the error code of the most recent error to occur * inside a Minet socket library function call. </p>
<p>Some functions inside Minet notify the caller of an error condition * by storing an error code inside this variable.</p>
<p>Note that this variable will only contain a meaningful value if the return value of the most recent Minet function call indicated that * an error occurred, <b>and</b> the documentation for that Minet function stated that you could call <a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a> to get more information about the error. Not all Minet functions use <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a> for reporting error codes; furthermore, calling additional Minet functions may change the value of <a class="el" href="minet__socket_8cc.html#aa623588010a1db5fee3d632b10687977" title="Contains the error code of the most recent error to occur * inside a Minet socket...">minet_errno</a>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Within Minet, an error code of <code>ENODEV</code> ("no device error") is often used to signify that Minet was not initialized properly. Check that the call to <a class="el" href="minet__socket_8cc.html#a1c3071d2961d94f18e08a4546a23f740" title="Initialize the Minet socket library.">minet_init()</a> succeeded.</dd>
<dd>
You can set <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> in <code>setup.sh</code> to 1 or greater to see more information about errors that occur while Minet is operating.</dd>
<dd>
This variable is similar in principle to the global variable <code>errno</code> in Linux. See the manual page entry for <code>errno(3)</code> ((<code>man 3 errno</code>)).</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="minet__socket_8cc.html#a13b935bebdc61d33fbca3101275bb28a" title="Returns the most recent error that occurred in a Minet function call.">minet_error()</a>, <a class="el" href="minet__socket_8cc.html#aa1c67d5c3fa57e48c57bec5eaec69f34" title="Prints a description for the most recent error that occurred in a Minet function...">minet_perror()</a>, <a class="el" href="debug_8h.html#a01020cbdcbeda98fdb1376369fa75c41" title="A value between 0 and 10 that specifies how much debugging information Minet should...">MINET_DEBUGLEVEL</a> </dd></dl>

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00059">59</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a122cc6e4fc3e6c05d53bccef3432c668"></a><!-- doxytag: member="minet_socket.cc::sock" ref="a122cc6e4fc3e6c05d53bccef3432c668" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_minet_8h.html#aa92e423eb4aac3116a67315a4dd8a60e">MinetHandle</a> <a class="el" href="minet__socket_8cc.html#a122cc6e4fc3e6c05d53bccef3432c668">sock</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00025">25</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a702607628089b0e9b1baa39615f088b2"></a><!-- doxytag: member="minet_socket.cc::socket_type" ref="a702607628089b0e9b1baa39615f088b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="minet__socket_8cc.html#a702607628089b0e9b1baa39615f088b2">socket_type</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="minet__socket_8cc_source.html#l00024">24</a> of file <a class="el" href="minet__socket_8cc_source.html">minet_socket.cc</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Aug 9 15:57:38 2010 for Minet by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
